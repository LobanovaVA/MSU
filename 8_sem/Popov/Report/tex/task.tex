\section{Описание схемы}

\subsection{Схема}
Обозначим через $G$ и $V_s$, $s = 1, \, \ldots, \, d$,
приближенные значения функций $\ln\rho$ и $u_s$ соответственно.

Для поиска численного решения задачи~\eqref{eq:main} с начальными условиями~\eqref{eq:terms} можно использовать следующую разностную схему:
\begin{equation} 
\label{eq:system}
\begin{cases}
    F_0 (G, \, V_1, \, \ldots, \, V_d) = f_0, & \vec{x} \in \internal \omega_h \\
    F_{0, \, s}^- (G, \, V_1, \, \ldots, \, V_d) = f_0, & \vec{x} \in \gamma_{h, \, s}^- \\
    F_{0, \, s}^+ (G, \, V_1, \, \ldots, \, V_d) = f_0, & \vec{x} \in \gamma_{h, \, s}^+ \\
    F_s (G, \, V_1, \, \ldots, \, V_d) = f_s, & \vec{x} \in \internal \omega_h \\
    \widehat{V}_s = 0, & \vec{x} \in \gamma_{h, \, s},
\end{cases}
\end{equation}
$s = 1, \, \ldots, \, d$, где
%
\begin{equation} 
\label{eq:short_1}
F_0 (G, \, V_1, \, \ldots, \, V_d) = G_t
+ \frac{1}{2} \sum_{i = 1}^{d} 
	\big( V_i \widehat{G}_{\mathring{x}_i} + (V_i \widehat{G})_{\mathring{x}_i} 
		  + 2 (\widehat{V}_i)_{\mathring{x}_i} - G (V_i)_{\mathring{x}_i} 
	\big)
- \tau \eta \sum_{i = 1}^{d} (\Phi_{\avg_i} \widehat{G}_{x_i})_{\overline{x}_i}
\end{equation}
%
\begin{equation} 
\label{eq:short_2}
F_{0, \, s}^- (G, \, V_1, \, \ldots, \, V_d) = G_t 
+ \frac{1}{2} \big( (V_s \widehat{G})_{x_s} + 2 (\widehat{V}_s)_{x_s} - G (V_s)_{x_s} \big)
- A_{s}^- - \tau \eta \frac{2 \Phi_{\avg_s}}{h_s} \widehat{G}_{x_s}
\end{equation}
%
\begin{equation} 
\label{eq:short_3}
F_{0, \, s}^+ (G, \, V_1, \, \ldots, \, V_d) = G_t 
+ \frac{1}{2} \big( (V_s \widehat{G})_{\overline{x}_s} + 2 (\widehat{V}_s)_{\overline{x}_s} - G (V_s)_{\overline{x}_s} \big)
+ A_{s}^+ + \tau \eta \frac{2 \Phi_{\overline{\avg}_s}}{h_s} \widehat{G}_{\overline{x}_s}
\end{equation}
%
\begin{equation} 
A_{s}^\pm (G, \, V_1, \, \ldots, \, V_d) = 0.5 h_s
\big[ (GV_k)_{x_s \overline{x}_s}^{\pm 1_s} - 0.5 (GV_k)_{x_s \overline{x}_s}^{\pm 2_s}
      (2 - G) ( (V_s))_{x_s \overline{x}_s}^{\pm 1_s}  - 0.5 (V_s)_{x_s \overline{x}_s}^{\pm 2_s} ) \big]
\end{equation}
%
\begin{multline} \label{eq:short_4}
F_s (G, \, V_1, \, \ldots, \, V_d) = \\ = (V_s)_t + \frac{1}{3} \big( V_s (\widehat{V}_s)_{\mathring{x}_s} + (V_s \widehat{V}_s)_{\mathring{x}_s} \big) + \frac{1}{2} \sum_{i = 1, \, i \not = s}^{d} \big( V_i (\widehat{V}_s)_{\mathring{x}_i} + (V_i \widehat{V}_s)_{\mathring{x}_i} - V_s (V_i)_{\mathring{x}_i} \big) + p_{\rho}(e^G) \widehat{G}_{\mathring{x}_s} - \\ - \widetilde{\mu} \, \bigg( \frac{4}{3} (\widehat{V}_s)_{x_s \overline{x}_s} + \sum_{i = 1, \, i \not = s}^{d} (\widehat{V}_s)_{x_i \overline{x}_i} \bigg) + (\widetilde{\mu} - \mu e^{-G}) \cdot \bigg( \frac{4}{3} (V_s)_{x_s \overline{x}_s} + \sum_{i = 1, \, i \not = s}^{d} (V_s)_{x_i \overline{x_i}} \bigg) - \frac{1}{3} \mu e^{-G} \sum_{i = 1, \, i \not = s}^{d} (V_i)_{\mathring{x}_s \mathring{x}_i},
\end{multline}
где
\begin{equation*}
    \widetilde{\mu} = \mu \, \| \exp(-G^n) \| = \mu \, \max_{m} |\exp (-G^n_m)| = \mu \, \exp \, \big(- \min_{m}G^n_m \big)
\end{equation*}
и функция $\Phi$ берется равной либо $e^G$, либо $V^2$.

Величина $\eta$ является положительной константой и подбирается экспериментально. Наличие слагаемых с коэффициентом $\eta$, называемых искусственными вязкостями, обусловлено использованием в схеме центральных разностей, которые приводят к появлению осцилляций у численного решения на фоне точного решения дифференциальной задачи.

В качестве значений разностного решения на нулевом слое берутся проекции на сетку $\omega_h$ функций $\ln \rho_0$ и $u_0$ (запись $g (h m)$ стоит понимать как $g (h_1 m_1, \, \ldots, \, h_d m_d)$):
\begin{equation*}
    G^0_m = \ln \rho_0 (h m), \quad V^0_m = \vec{u}_0 (h m),
\end{equation*}
а граничные значения скорости полагаются равными нулю (последнее уравнение в~\eqref{eq:system}):
\begin{equation*}
    V^n_m = 0,
\end{equation*}
$n = 1, \, \ldots, \, N$.

Так как
\begin{equation*}
    p_\rho (e^g) = C \gamma e^{(\gamma - 1) g}
\end{equation*}
для $p (\rho) = C \rho^\gamma$, то
\begin{equation*}
    p_\rho (e^{G^n_m}) = C \gamma e^{(\gamma - 1) G^n_m}.
\end{equation*}




\subsection{Координатная запись уравнений}
Пользуясь обозначениями, приведенными в разделе~\ref{sec:notation}, перепишем уравнения из~\eqref{eq:system} в координатном виде.

\subsubsection{Первое уравнение}
Рассматриваем уравнение~\eqref{eq:short_1}: 

\begin{equation*} 
F_0 (G, \, V_1, \, \ldots, \, V_d) = G_t
+
\frac{1}{2} \sum_{i = 1}^{d} \big( V_i \widehat{G}_{\mathring{x}_i} + (V_i \widehat{G})_{\mathring{x}_i} + 2 (\widehat{V}_i)_{\mathring{x}_i} - G (V_i)_{\mathring{x}_i} \big)
-
\tau \eta \sum_{i = 1}^{d} (\Phi_{\avg_i} \widehat{G}_{x_i})_{\overline{x}_i}
\end{equation*}

Распишем в общем случае:
\begin{multline*}
F_0 (G, \, V_1, \, \ldots, \, V_d) = 
\bigg( \frac{1}{\tau} + \tau \eta \sum_{i = 1}^{d} \frac{\Phi^n_{m + 1_i} + 2 \Phi^n_m + \Phi^n_{m - 1_i}}{2 h_i^2} \bigg) \, G^{n+1}_m
+ \\ +
\sum_{i = 1}^{d} \bigg( - \frac{(V_i)^n_m + (V_i)^n_{m - 1_i}}{4 h_i} - \tau \eta \frac{(\Phi^n_m + \Phi^n_{m - 1_i})}{2 h_i^2} \bigg) \, G^{n+1}_{m - 1_i}
+
\sum_{i = 1}^{d} \bigg( \frac{(V_i)^n_m + (V_i)^n_{m + 1_i}}{4 h_i} - \tau \eta \frac{(\Phi^n_m + \Phi^n_{m + 1_i})}{2 h_i^2} \bigg) \, G^{n+1}_{m + 1_i}
+ \\ +
\sum_{i = 1}^{d} \bigg( - \frac{1}{2 h_i} \bigg) \, (V_i)^{n+1}_{m - 1_i}
+
\sum_{i = 1}^{d} \bigg( \frac{1}{2 h_i} \bigg) \, (V_i)^{n+1}_{m + 1_i}
-
\bigg( \frac{G^n_m}{\tau} + \sum_{i = 1}^{d} G^n_m \frac{(V_i)^n_{m + 1_i} - (V_i)^n_{m - 1_i}}{4 h_i} \bigg)
\end{multline*}

В программной реализации будем полагать $\eta = 0$:
\begin{multline*}
F_0 (G, \, V_1, \, \ldots, \, V_d) = 
\bigg( \frac{1}{\tau} \bigg) \, G^{n+1}_m
+
\sum_{i = 1}^{d} \bigg( - \frac{(V_i)^n_m + (V_i)^n_{m - 1_i}}{4 h_i} \bigg) \, G^{n+1}_{m - 1_i}
+
\sum_{i = 1}^{d} \bigg(   \frac{(V_i)^n_m + (V_i)^n_{m + 1_i}}{4 h_i} \bigg) \, G^{n+1}_{m + 1_i}
+ \\ +
\sum_{i = 1}^{d} \bigg( - \frac{1}{2 h_i} \bigg) \, (V_i)^{n+1}_{m - 1_i}
+
\sum_{i = 1}^{d} \bigg( \frac{1}{2 h_i} \bigg) \, (V_i)^{n+1}_{m + 1_i}
-
\bigg( \frac{G^n_m}{\tau} + \sum_{i = 1}^{d} G^n_m \frac{(V_i)^n_{m + 1_i} - (V_i)^n_{m - 1_i}}{4 h_i} \bigg)
\end{multline*}

Домножим на $4\tau$ и раскроем суммы для $d=2$:
\begin{multline*}
4 \tau \, F_0 (G, \, V_1, \, V_2) = 
4 \, G^{n+1}_m
+ \bigg( - \frac{\tau}{h_1} \bigg) \bigg( {V_1}^n_m + {V_1}^n_{m_1 - 1, m_2} \bigg) \, G^{n+1}_{m_1 - 1, m_2}
+ \bigg( - \frac{\tau}{h_2} \bigg) \bigg( {V_2}^n_m + {V_2}^n_{m_1, m_2 - 1} \bigg) \, G^{n+1}_{m_1, m_2 - 1}
+ \\ +
  \bigg(   \frac{\tau}{h_1} \bigg) \bigg( {V_1}^n_m + {V_1}^n_{m_1 + 1, m_2} \bigg) \, G^{n+1}_{m_1 + 1, m_2}
+ \bigg(   \frac{\tau}{h_2} \bigg) \bigg( {V_2}^n_m + {V_2}^n_{m_1, m_2 + 1} \bigg) \, G^{n+1}_{m_1, m_2 + 1}
+ \\ +
  \bigg( -\frac{2\tau}{h_1} \bigg) {V_1}^{n+1}_{m_1 - 1, m_2}
+ \bigg( -\frac{2\tau}{h_2} \bigg) {V_2}^{n+1}_{m_1, m_2 - 1}
+ \bigg(  \frac{2\tau}{h_1} \bigg) {V_1}^{n+1}_{m_1 + 1, m_2}
+ \bigg(  \frac{2\tau}{h_2} \bigg) {V_2}^{n+1}_{m_1, m_2 + 1}
- \\ -
\bigg[ 4
  + \bigg( \frac{\tau}{h_1} \bigg) \bigg( {V_1}^n_{m_1 + 1, m_2} - {V_1}^n_{m_1 - 1, m_2} \bigg)
  + \bigg( \frac{\tau}{h_2} \bigg) \bigg( {V_2}^n_{m_1, m_1 + 1} - {V_2}^n_{m_1, m_2 - 1} \bigg)
\bigg] G^n_m
\end{multline*}
$\vec{x} \in \internal \omega_h :\; (m_1; \, m_2) \in (1, \, \ldots, \, M_1 - 1;\, 1, \, \ldots, \,M_2 - 1)$


\subsubsection{Второе уравнение}
Рассматриваем уравнение~\eqref{eq:short_2}: 
\begin{equation*}
F_{0, \, s}^- (G, \, V_1, \, \ldots, \, V_d) = G_t 
+ \frac{1}{2} \big( (V_s \widehat{G})_{x_s} + 2 (\widehat{V}_s)_{x_s} - G (V_s)_{x_s} \big)
- A_{s}^- - \tau \eta \frac{2 \Phi_{\avg_s}}{h_s} \widehat{G}_{x_s}
\end{equation*}

Распишем в общем случае:
\begin{multline*}
F_{0, \, s}^- (G, \, V_1, \, \ldots, \, V_d) = 
\bigg( \frac{1}{\tau} - \frac{(V_s)^n_m}{2 h_s} + \tau \eta \frac{\Phi^n_m + \Phi^n_{m + 1_s}}{h_s^2} \bigg) \, G^{n+1}_m
+
\bigg( \frac{(V_s)^n_{m + 1_s}}{2 h_s} - \tau \eta \frac{\Phi^n_m + \Phi^n_{m + 1_s}}{h_s^2} \bigg) \, G^{n+1}_{m + 1_s}
+ \\ +
\bigg( - \frac{1}{h_s} \bigg) \, (V_s)^{n+1}_m
+
\bigg( \frac{1}{h_s} \bigg) \, (V_s)^{n+1}_{m + 1_s}
-
\bigg( \frac{G^n_m}{\tau} + G^n_m \frac{(V_s)^n_{m + 1_s} - (V_s)^n_m}{2 h_s} \bigg) - A_{s}^-
\end{multline*}

В программной реализации будем полагать $\eta = 0$:
\begin{multline*}
F_{0, \, s}^- (G, \, V_1, \, \ldots, \, V_d) = 
\bigg( \frac{1}{\tau} - \frac{(V_s)^n_m}{2 h_s} \bigg) \, G^{n+1}_m
+
\bigg( \frac{(V_s)^n_{m + 1_s}}{2 h_s} \bigg) \, G^{n+1}_{m + 1_s}
+ \\ +
\bigg( - \frac{1}{h_s} \bigg) \, (V_s)^{n+1}_m
+
\bigg(   \frac{1}{h_s} \bigg) \, (V_s)^{n+1}_{m + 1_s}
-
\bigg( \frac{G^n_m}{\tau} + G^n_m \frac{(V_s)^n_{m + 1_s} - (V_s)^n_m}{2 h_s} \bigg) - A_{s}^-
\end{multline*}

Домножим на $2\tau$ и запишем для $d=2$, $s=1$:
\begin{multline*}
2\tau F_{0, \, 1}^- (G, \, V_1, \, V_2) = 
\bigg( 2 - \frac{\tau}{h_1} \; {V_1}^n_m \bigg) \, G^{n+1}_m
+ \bigg(   \frac{\tau}{h_1} \; {V_1}^n_{m_1 + 1, m_2} \bigg) \, G^{n+1}_{m_1 + 1, m_2}
+ \\ +
  \bigg( - \frac{2\tau}{h_1} \bigg) \, {V_1}^{n+1}_m
+ \bigg(   \frac{2\tau}{h_1} \bigg) \, {V_1}^{n+1}_{m_1 + 1, m_2}
- \bigg[ 2  
   + \bigg( \frac{\tau}{h_1} \bigg) \bigg( {V_1}^n_{m_1 + 1, m_2} - {V_1}^n_m \bigg)
  \bigg] G^n_m - 2\tau A_{1}^-
\end{multline*}

\begin{multline*}
2\tau A_{1}^- (G, \, V_1, \, V_2) = \frac{2\tau}{h_1}
\bigg[ - 2.5 G^{n}_{m_1 + 1, m_2} {V_1}^{n}_{m_1 + 1, m_2} 
       + 2   G^{n}_{m_1 + 2, m_2} {V_1}^{n}_{m_1 + 2, m_2} 
       - 0.5 G^{n}_{m_1 + 3, m_2} {V_1}^{n}_{m_1 + 3, m_2} 
+ \\ + (2 - G^{n}_{m}) (
   	   - 2.5 {V_1}^{n}_{m_1 + 1, m_2} 
       + 2   {V_1}^{n}_{m_1 + 2, m_2} 
       - 0.5 {V_1}^{n}_{m_1 + 3, m_2} 
) \bigg]
\end{multline*}

$\vec{x} \in \gamma_{\vec{h}, \, 1}^-:\; (m_1; \, m_2) \in (0; \, 0, \, \ldots, \, M_2)$ \\
$\vec{x} \in \gamma_{\vec{h}, \, 2}^-:\; (m_1; \, m_2) \in (0, \, \ldots, \, M_1; \, 0)$



\subsubsection{Третье уравнение}
Рассматриваем уравнение~\eqref{eq:short_3}: 
\begin{equation*}
F_{0, \, s}^+ (G, \, V_1, \, \ldots, \, V_d) = G_t 
+ \frac{1}{2} \big( (V_s \widehat{G})_{\overline{x}_s} + 2 (\widehat{V}_s)_{\overline{x}_s} - G (V_s)_{\overline{x}_s} \big)
+ A_{s}^+ + \tau \eta \frac{2 \Phi_{\overline{\avg}_s}}{h_s} \widehat{G}_{\overline{x}_s}
\end{equation*}

Распишем в общем случае:
\begin{multline*}
F_{0, \, s}^+ (G, \, V_1, \, \ldots, \, V_d) = 
\bigg( \frac{1}{\tau} + \frac{(V_s)^n_m}{2 h_s} + \tau \eta \frac{\Phi^n_m + \Phi^n_{m - 1_s}}{h_s^2} \bigg) \, G^{n+1}_m
+
\bigg( - \frac{(V_s)^n_{m - 1_s}}{2 h_s} - \tau \eta \frac{\Phi^n_m + \Phi^n_{m + 1_s}}{h_s^2} \bigg) \, G^{n+1}_{m - 1_s}
+ \\ +
\bigg( \frac{1}{h_s} \bigg) \, (V_s)^{n+1}_m
+
\bigg( - \frac{1}{h_s} \bigg) \, (V_s)^{n+1}_{m - 1_s}
-
\bigg( \frac{G^n_m}{\tau} + G^n_m \frac{(V_s)^n_m - (V_s)^n_{m - 1_s}}{2 h_s} \bigg) + A_{s}^+
\end{multline*}

В программной реализации будем полагать $\eta = 0$:
\begin{multline*}
F_{0, \, s}^+ (G, \, V_1, \, \ldots, \, V_d) = 
\bigg( \frac{1}{\tau} + \frac{(V_s)^n_m}{2 h_s} \bigg) \, G^{n+1}_m
+
\bigg( - \frac{(V_s)^n_{m - 1_s}}{2 h_s} \bigg) \, G^{n+1}_{m - 1_s}
+ \\ +
\bigg(   \frac{1}{h_s} \bigg) \, (V_s)^{n+1}_m
+
\bigg( - \frac{1}{h_s} \bigg) \, (V_s)^{n+1}_{m - 1_s}
-
\bigg( \frac{G^n_m}{\tau} + G^n_m \frac{(V_s)^n_m - (V_s)^n_{m - 1_s}}{2 h_s} \bigg) + A_{s}^+
\end{multline*}

Домножим на $2\tau$ и запишем для $d=2$, $s=1$:
\begin{multline*}
2\tau F_{0, \, 1}^+ (G, \, V_1, \, V_2) = 
\bigg( 2 + \frac{\tau}{h_1} \; {V_1}^n_m \bigg) \, G^{n+1}_m
+ \bigg( - \frac{\tau}{h_1} \; {V_1}^n_{m_1 + 1, m_2} \bigg) \, G^{n+1}_{m_1 + 1, m_2}
+ \\ +
  \bigg(   \frac{2\tau}{h_1} \bigg) \, {V_1}^{n+1}_m
+ \bigg( - \frac{2\tau}{h_1} \bigg) \, {V_1}^{n+1}_{m_1 + 1, m_2}
- \bigg[ 2  
   + \bigg( \frac{\tau}{h_1} \bigg) \bigg( {V_1}^n_m - {V_1}^n_{m_1 - 1, m_2}\bigg)
  \bigg] G^n_m - 2\tau A_{1}^+
\end{multline*}

\begin{multline*}
2\tau A_{1}^+ (G, \, V_1, \, V_2) = \frac{2\tau}{h_1}
\bigg[ - 2.5 G^{n}_{m_1 - 1, m_2} {V_1}^{n}_{m_1 - 1, m_2} 
       + 2   G^{n}_{m_1 - 2, m_2} {V_1}^{n}_{m_1 - 2, m_2} 
       - 0.5 G^{n}_{m_1 - 3, m_2} {V_1}^{n}_{m_1 - 3, m_2} 
+ \\ + (2 - G^{n}_{m}) (
   	   - 2.5 {V_1}^{n}_{m_1 - 1, m_2} 
       + 2   {V_1}^{n}_{m_1 - 2, m_2} 
       - 0.5 {V_1}^{n}_{m_1 - 3, m_2} 
) \bigg]
\end{multline*}

$\vec{x} \in \gamma_{\vec{h}, \, 1}^+:\; (m_1; \, m_2) \in (M_1; \, 0, \, \ldots, \, M_2)$ \\
$\vec{x} \in \gamma_{\vec{h}, \, 2}^+:\; (m_1; \, m_2) \in (0, \, \ldots, \, M_1; \, M_2)$


\subsubsection{Четвертое уравнение}
Рассматриваем уравнение~\eqref{eq:short_4}: 
\begin{multline*}
F_s (G, \, V_1, \, \ldots, \, V_d) = \\ = (V_s)_t + \frac{1}{3} \big( V_s (\widehat{V}_s)_{\mathring{x}_s} + (V_s \widehat{V}_s)_{\mathring{x}_s} \big) + \frac{1}{2} \sum_{i = 1, \, i \not = s}^{d} \big( V_i (\widehat{V}_s)_{\mathring{x}_i} + (V_i \widehat{V}_s)_{\mathring{x}_i} - V_s (V_i)_{\mathring{x}_i} \big) + p_{\rho}(e^G) \widehat{G}_{\mathring{x}_s} - \\ - \widetilde{\mu} \, \bigg( \frac{4}{3} (\widehat{V}_s)_{x_s \overline{x}_s} + \sum_{i = 1, \, i \not = s}^{d} (\widehat{V}_s)_{x_i \overline{x}_i} \bigg) + (\widetilde{\mu} - \mu e^{-G}) \cdot \bigg( \frac{4}{3} (V_s)_{x_s \overline{x}_s} + \sum_{i = 1, \, i \not = s}^{d} (V_s)_{x_i \overline{x_i}} \bigg) - \frac{1}{3} \mu e^{-G} \sum_{i = 1, \, i \not = s}^{d} (V_i)_{\mathring{x}_s \mathring{x}_i}
\end{multline*}

Распишем в общем случае:
\begin{multline*}
F_s (G, \, V_1, \, \ldots, \, V_d) = \frac{(V_s)^{n+1}_m - (V_s)^n_m}{\tau}
\, + \\ +
\frac{1}{3} \bigg[ (V_s)^n_m \frac{(V_s)^{n+1}_{m + 1_s} - (V_s)^{n+1}_{m - 1_s}}{2 h_s} + \frac{(V_s)^n_{m + 1_s} (V_s)^{n+1}_{m + 1_s} - (V_s)^n_{m - 1_s} (V_s)^{n+1}_{m - 1_s}}{2 h_s} \bigg]
\, + \\ +
\frac{1}{2} \sum_{i = 1, \, i \not = s}^{d} \bigg[ (V_i)^n_m \frac{(V_s)^{n+1}_{m + 1_i} - (V_s)^{n+1}_{m - 1_i}}{2 h_i} + \frac{(V_i)^n_{m + 1_i} (V_s)^{n+1}_{m + 1_i} - (V_i)^n_{m - 1_i} (V_s)^{n+1}_{m - 1_i}}{2 h_i}
\, - \\ -
(V_s)^n_m \frac{(V_i)^n_{m + 1_i} - (V_i)^n_{m - 1_i}}{2 h_i} \bigg]
\, +
p_{\rho}(\exp (G^n_m)) \cdot \frac{G^{n+1}_{m + 1_s} - G^{n+1}_{m - 1_s}}{2 h_s}
\, - \\ -
\widetilde{\mu} \, \bigg[ \frac{4}{3} \frac{(V_s)^{n+1}_{m + 1_s} - 2 (V_s)^{n+1}_m + (V_s)^{n+1}_{m - 1_s}}{h_s^2} + \sum_{i = 1, \, i \not = s}^{d} \frac{(V_s)^{n+1}_{m + 1_i} - 2 (V_s)^{n+1}_m + (V_s)^{n+1}_{m - 1_i}}{h_i^2} \bigg]
\, + \\ +
(\widetilde{\mu} - \mu \exp(-G^n_m)) \cdot \bigg[ \frac{4}{3} \frac{(V_s)^n_{m + 1_s} - 2 (V_s)^n_m + (V_s)^n_{m - 1_s}}{h_s^2} + \sum_{i = 1, \, i \not = s}^{d} \frac{(V_s)^n_{m + 1_i} - 2 (V_s)^n_m + (V_s)^n_{m - 1_i}}{h_i^2} \bigg]
\, - \\ -
\frac{1}{3} \mu \exp(-G^n_m) \sum_{i = 1, \, i \not = s}^{d} \frac{(V_i)^n_{m + 1_s + 1_i} - (V_i)^n_{m + 1_s - 1_i} - (V_i)^n_{m - 1_s + 1_i} + (V_i)^n_{m - 1_s - 1_i}}{4 h_s h_i}
\end{multline*}

Сгруппируем:
\begin{multline*}
F_s (G, \, V_1, \, \ldots, \, V_d) 
= \\ =
\bigg( - \frac{p_{\rho}(\exp (G^n_m))}{2 h_s} \bigg) \, G^{n+1}_{m - 1_s}
+
\bigg( \frac{p_{\rho}(\exp (G^n_m))}{2 h_s} \bigg) \, G^{n+1}_{m + 1_s}
+
\bigg( \frac{1}{\tau} + \frac{8 \widetilde{\mu}}{3 h_s^2} + \sum_{i = 1, \, i \not = s}^{d} \frac{2 \widetilde{\mu}}{h_i^2} \bigg) \, (V_s)^{n+1}_m
+ \\ +
\bigg( - \frac{(V_s)^n_m + (V_s)^n_{m - 1_s}}{6 h_s} - \frac{4 \widetilde{\mu}}{3 h_s^2} \bigg) \, (V_s)^{n+1}_{m - 1_s}
+
\sum_{i = 1, \, i \not = s}^{d} \bigg( - \frac{(V_i)^n_m + (V_i)^n_{m - 1_i}}{4 h_i} - \frac{\widetilde{\mu}}{h_i^2} \bigg) \, (V_s)^{n+1}_{m - 1_i}
+ \\ +
\bigg( \frac{(V_s)^n_m + (V_s)^n_{m + 1_s}}{6 h_s} - \frac{4 \widetilde{\mu}}{3 h_s^2} \bigg) \, (V_s)^{n+1}_{m + 1_s}
+
\sum_{i = 1, \, i \not = s}^{d} \bigg( \frac{(V_i)^n_m + (V_i)^n_{m + 1_i}}{4 h_i} - \frac{\widetilde{\mu}}{h_i^2} \bigg) \, (V_s)^{n+1}_{m + 1_i}
- B_s
\end{multline*}

\begin{multline*}
B_s (G, \, V_1, \, \ldots, \, V_d) =
\frac{(V_s)^n_m}{\tau} + \sum_{i = 1, \, i \not = s}^{d} (V_s)^n_m \frac{(V_i)^n_{m + 1_i} - (V_i)^n_{m - 1_i}}{4 h_i} 
\,- \\ -
(\widetilde{\mu} - \mu \exp(-G^n_m)) \cdot \bigg[ \frac{4}{3} \frac{(V_s)^n_{m + 1_s} - 2 (V_s)^n_m + (V_s)^n_{m - 1_s}}{h_s^2} + \sum_{i = 1, \, i \not = s}^{d} \frac{(V_s)^n_{m + 1_i} - 2 (V_s)^n_m + (V_s)^n_{m - 1_i}}{h_i^2} \bigg]
\, + \\ +
\frac{1}{3} \mu \exp(-G^n_m) \sum_{i = 1, \, i \not = s}^{d} \frac{(V_i)^n_{m + 1_s + 1_i} - (V_i)^n_{m + 1_s - 1_i} - (V_i)^n_{m - 1_s + 1_i} + (V_i)^n_{m - 1_s - 1_i}}{4 h_s h_i}
\end{multline*}

Домножим на $6\tau$ и запишем для $d=2$, $s=1$:
\begin{multline*}
6\tau F_s (G, \, V_1, \, V_2) 
= \\ =
\bigg( \frac{3 \tau p_{\rho}}{h_1} \; \exp (G^n_m) \bigg) \, G^{n+1}_{m_1 - 1, m_2}
+
\bigg( \frac{3 \tau p_{\rho}}{h_1} \; \exp (G^n_m) \bigg) \, G^{n+1}_{m_1 + 1, m_2}
+
\bigg[ 6 + 4 \tau \widetilde{\mu}  \bigg( \frac{4}{h_1^2} + \frac{3}{h_2^3} \bigg) \bigg] \, {V_1}^{n+1}_{m}
- \\ -
\bigg[ \frac{\tau}{h_1}     \bigg( {V_1}^{n}_{m_1 - 1, m_2} + {V_1}^{n}_{m} \bigg) + \frac{8 \tau \widetilde{\mu}}{h_1^2} \bigg] \, {V_1}^{n+1}_{m_1 - 1, m_2}
-
\bigg[ \frac{3 \tau}{2 h_2} \bigg( {V_2}^{n}_{m_1, m_2 - 1} + {V_1}^{n}_{m} \bigg) + \frac{6 \tau \widetilde{\mu}}{h_2^2} \bigg] \, {V_1}^{n+1}_{m_1, m_2 - 1}
+ \\ +
\bigg[ \frac{\tau}{h_1}     \bigg( {V_1}^{n}_{m_1 + 1, m_2} + {V_1}^{n}_{m} \bigg) - \frac{8 \tau \widetilde{\mu}}{h_1^2} \bigg] \, {V_1}^{n+1}_{m_1 + 1, m_2}
+
\bigg[ \frac{3 \tau}{2 h_2} \bigg( {V_2}^{n}_{m_1, m_2 + 1} + {V_1}^{n}_{m} \bigg) - \frac{6 \tau \widetilde{\mu}}{h_2^2} \bigg] \, {V_1}^{n+1}_{m_1, m_2 + 1}
- B_s
\end{multline*}


\begin{multline*}
6\tau B_1 (G, \, V_1, \, V_2) =
\bigg[ 6 + \frac{3 \tau}{2 h_2} \bigg( {V_2}^{n}_{m_1, m_2 + 1} - {V_2}^{n}_{m_1, m_2 - 1} \bigg) \bigg] {V_1}^{n}_{m} 
- \\ -
6\tau (\widetilde{\mu} - \mu \exp(-G^n_m)) \cdot \bigg[ 
	\frac{4}{3 h_1^2} \bigg( {V_1}^n_{m_1 + 1, m_2} - 2 {V_1}^{n}_{m}  + {V_1}^n_{m_1 - 1, m_2} \bigg) +
	\frac{1}{  h_2^2} \bigg( {V_1}^n_{m_1, m_2 + 1} - 2 {V_1}^{n}_{m}  + {V_1}^n_{m_1, m_2 - 1} \bigg)  \bigg]
\, + \\ +
\frac{\tau \mu}{2 h_1 h_2} \exp(-G^n_m)
	\bigg( {V_2}^n_{m_1 + 1, m_2 + 1} - {V_2}^n_{m_1 - 1, m_2 + 1} - {V_2}^n_{m_1 + 1, m_2 - 1} + {V_2}^n_{m_1 - 1, m_2 - 1} \bigg)
\end{multline*}



\subsection{Описание области}
Задана область $$\Omega = \Omega_{01} \cup \Omega_{02} \cup \Omega_{11} \cup \Omega_{12} \cup \Omega_{10} \cup \Omega_{10} \cup \Omega_{20} $$.

Неизвестные функции: плотность $\rho$ и вектор скорости $\vec{u}$ являются функциями переменных Эйлера $(t, x) \in Q = [0, T] \times \Omega$.

Граничные условия для неизвестного решения: 
$$
	\rho \big|_{\Gamma-} = \rho_\gamma = 1  \,, \quad
	u_1 \big|_{\Gamma-} = w                 \,, \quad
	\deriv{u_1}{x} \big|_{\Gamma+} = 0
$$
На оставшейся границе компоненты скорости равны нулю, а функция плотности считается неизвестной.

\newpage
\begin{figure}[h!] \centering
	\includegraphics[scale=0.8]{area.pdf}
	\captionof{figure}{Заданная область}\label{chop:diag}
\end{figure}
